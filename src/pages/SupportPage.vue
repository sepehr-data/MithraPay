<template>
  <section
      id="contact"
      class="relative py-14 lg:py-20 overflow-hidden"
      dir="rtl"
  >
    <!-- ูพุณโุฒููู ุฏฺฉูุฑุงุชู -->
    <div
        class="pointer-events-none absolute inset-0 opacity-70"
        aria-hidden="true"
    >
      <div
          class="absolute -left-24 top-0 w-64 h-64 bg-primary/10 rounded-full blur-3xl"
      ></div>
      <div
          class="absolute -right-16 bottom-0 w-72 h-72 bg-secondary/10 rounded-full blur-3xl"
      ></div>
      <div
          class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[420px] h-[420px] border border-base-300/60 rounded-full opacity-40"
      ></div>
    </div>

    <div class="max-w-6xl mx-auto px-4 lg:px-0 relative z-10 space-y-10">
      <!-- ูุฏุฑ ุจุงูุง -->
      <div class="flex flex-col items-center text-center gap-3">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-base-100/70 border border-base-200 shadow-sm">
          <span class="w-2 h-2 rounded-full bg-success animate-pulse"></span>
          <span class="text-[11px] text-base-content/70">
            ูพุดุชุจุงู ูุนุงู โข ุฌูุงุจโฺฏู ุฏุฑ ฺฉูุชุฑ ุงุฒ ฒด ุณุงุนุช
          </span>
        </div>

        <h2 class="text-2xl md:text-3xl font-extrabold tracking-tight">
          ฺฉ ูพุงู ฺฉูุชุงู ุชุง ุญู ุดุฏู ุณูุงูโุชุงู
        </h2>
        <p class="max-w-2xl text-sm md:text-[15px] text-base-content/70">
          ุฏุฑ ููุฑุฏ ุฎุฑุฏุ ูุนุงูโุณุงุฒ ุงุดุชุฑุงฺฉุ ุง ุญุช ูุจู ุงุฒ ุซุจุช ุณูุงุฑุด ุณูุงู ุฏุงุฑุฏุ
          ูุฑู ุฒุฑ ุฑุง ูพุฑ ฺฉูุฏ ุชุง ุชู ูุชุฑุงูพ ุจูโุตูุฑุช ุงุฎุชุตุงุต ุฑุงูููุงุชุงู ฺฉูุฏ.
        </p>
      </div>

      <!-- ฺฏุฑุฏ ุงุตู -->
      <div
          class="grid gap-6 lg:gap-8 lg:grid-cols-[minmax(0,1.1fr)_minmax(0,0.9fr)] items-start"
      >
        <!-- ฺฉุงุฑุช ูุฑู (glass) -->
        <div
            class="card glass bg-base-100/90 border border-base-200/80 shadow-xl shadow-base-300/40"
        >
          <div class="card-body space-y-5">
            <!-- ุชุชุฑ ฺฉุงุฑุช + ฺูพ: ฺฉูฺฺฉ -->
            <div class="flex items-center justify-between gap-3">
              <div class="space-y-1 text-right">
                <h3 class="text-lg md:text-xl font-bold">
                  ูุฑู ุงุฑุชุจุงุท ุจุง ูพุดุชุจุงู
                </h3>
                <p class="text-xs text-base-content/60">
                  ุงุทูุงุนุงุช ุชูุงุณโุชุงู ุฑุง ฺฉุงูู ูุงุฑุฏ ฺฉูุฏ ุชุง ุณุฑุนโุชุฑ ูพุงุณุฎ ุจฺฏุฑุฏ.
                </p>
              </div>
              <div
                  class="hidden sm:flex flex-col items-center justify-center px-2 py-1 rounded-xl bg-base-200/80 text-[11px] text-base-content/70"
              >
                <span>ูุงูฺฏู ูพุงุณุฎโฺฏู</span>
                <span class="font-semibold text-primary">ฺฉูุชุฑ ุงุฒ ฒด ุณุงุนุช</span>
              </div>
            </div>

            <form class="space-y-4" @submit.prevent="handleSubmit">
              <!-- ุฑุฏู ุงูู -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <label class="form-control w-full">
                  <div class="label">
                    <span class="label-text text-xs md:text-sm">
                      ูุงู ู ูุงูโุฎุงููุงุฏฺฏ
                    </span>
                    <span
                        class="label-text-alt text-error text-[11px]"
                        v-if="errors.name"
                    >
                      {{ errors.name }}
                    </span>
                  </div>
                  <input
                      v-model="form.name"
                      type="text"
                      class="input input-bordered w-full input-sm md:input-md"
                      placeholder="ูุซูุงู: ุงูุฑ ุฑุถุง"
                  />
                </label>

                <label class="form-control w-full">
                  <div class="label">
                    <span class="label-text text-xs md:text-sm">ุงูู</span>
                    <span
                        class="label-text-alt text-error text-[11px]"
                        v-if="errors.email"
                    >
                      {{ errors.email }}
                    </span>
                  </div>
                  <input
                      v-model="form.email"
                      type="email"
                      class="input input-bordered w-full input-sm md:input-md ltr:!text-left"
                      placeholder="you@example.com"
                  />
                </label>
              </div>
              <!-- โ ููุถูุน ูพุงู (ฺฉ ุณุทุฑ ฺฉุงูู) -->
              <label class="form-control">
                <div class="label">
    <span class="label-text text-xs md:text-sm">
      ููุถูุน ูพุงู
    </span>
                  <span
                      v-if="errors.subject"
                      class="label-text-alt text-error text-[11px]"
                  >
      {{ errors.subject }}
    </span>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-[11px] md:text-xs">
                  <button
                      type="button"
                      class="btn btn-xs md:btn-sm rounded-full justify-center"
                      :class="form.subject === 'order' ? 'btn-primary' : 'btn-outline'"
                      @click="form.subject = 'order'"
                  >
                    ุณูุงุฑุด / ุฎุฑุฏ
                  </button>

                  <button
                      type="button"
                      class="btn btn-xs md:btn-sm rounded-full justify-center"
                      :class="form.subject === 'activation' ? 'btn-primary' : 'btn-outline'"
                      @click="form.subject = 'activation'"
                  >
                    ูุนุงูโุณุงุฒ
                  </button>

                  <button
                      type="button"
                      class="btn btn-xs md:btn-sm rounded-full justify-center"
                      :class="form.subject === 'billing' ? 'btn-primary' : 'btn-outline'"
                      @click="form.subject = 'billing'"
                  >
                    ูพุฑุฏุงุฎุช / ูุงู
                  </button>

                  <button
                      type="button"
                      class="btn btn-xs md:btn-sm rounded-full justify-center"
                      :class="form.subject === 'other' ? 'btn-primary' : 'btn-outline'"
                      @click="form.subject = 'other'"
                  >
                    ุณุงุฑ ููุงุฑุฏ
                  </button>
                </div>
              </label>

              <!-- โ ุดูุงุฑู ุชูุงุณ (ุฒุฑ ููุถูุน) -->
              <label class="form-control">
                <div class="label">
    <span class="label-text text-xs md:text-sm">
      ุดูุงุฑู ุณูุงุฑุด (ุงุฎุชุงุฑ)
    </span>
                  <span class="label-text-alt text-[11px] text-base-content/50">
      ุจุฑุง ูพฺฏุฑ ุณุฑุนโุชุฑ ูพุดููุงุฏ ูโุดูุฏ ูุงุฑุฏ ฺฉูุฏ
    </span>
                </div>
                <input
                    v-model="form.phone"
                    type="tel"
                    class="input input-bordered input-sm md:input-md ltr:!text-left"
                    placeholder="123XXXXXXX"
                />
              </label>


              <!-- ูพุงู -->
              <label class="form-control">
                <div class="label">
                  <span class="label-text text-xs md:text-sm">ูุชู ูพุงู</span>
                  <span
                      class="label-text-alt text-error text-[11px]"
                      v-if="errors.message"
                  >
                    {{ errors.message }}
                  </span>
                </div>
                <textarea
                    v-model="form.message"
                    class="textarea textarea-bordered min-h-[130px] md:min-h-[150px] text-sm"
                    placeholder="ูุทูุงู ูุดฺฉู ุง ุณูุงู ุฎูุฏ ุฑุง ุจุง ุฌุฒุฆุงุช ุจููุณุฏ."
                ></textarea>
              </label>

              <!-- ฺฉุงูุงู ุชุฑุฌุญ -->
              <div class="grid grid-cols-1 md:grid-cols-[minmax(0,1.2fr)_minmax(0,0.8fr)] gap-4 items-center">
                <div class="form-control">
                  <div class="label">
                    <span class="label-text text-xs md:text-sm">
                      ุฑูุด ุชุฑุฌุญ ุงุฑุชุจุงุท
                    </span>
                  </div>
                  <div class="join join-vertical md:join-horizontal w-full">
                    <button
                        type="button"
                        class="btn btn-sm md:btn-xs lg:btn-sm join-item justify-center"
                        :class="{
                        'btn-primary btn-active':
                          form.preferredChannel === 'email',
                        'btn-ghost':
                          form.preferredChannel !== 'email',
                      }"
                        @click="form.preferredChannel = 'email'"
                    >
                      ุงูู
                    </button>
                    <button
                        type="button"
                        class="btn btn-sm md:btn-xs lg:btn-sm join-item justify-center"
                        :class="{
                        'btn-primary btn-active':
                          form.preferredChannel === 'phone',
                        'btn-ghost':
                          form.preferredChannel !== 'phone',
                      }"
                        @click="form.preferredChannel = 'phone'"
                    >
                      ุชูุงุณ ุชููู
                    </button>
                    <button
                        type="button"
                        class="btn btn-sm md:btn-xs lg:btn-sm join-item justify-center"
                        :class="{
                        'btn-primary btn-active':
                          form.preferredChannel === 'whatsapp',
                        'btn-ghost':
                          form.preferredChannel !== 'whatsapp',
                      }"
                        @click="form.preferredChannel = 'whatsapp'"
                    >
                      ูุงุชุณุงูพ
                    </button>
                  </div>
                </div>

                <!-- ฺฺฉโุจุงฺฉุณ ููุงูู -->
                <label
                    class="flex items-start gap-2 text-[11px] md:text-xs cursor-pointer bg-base-200/60 rounded-xl px-3 py-2 border border-base-300/70"
                >
                  <input
                      v-model="form.acceptPolicy"
                      type="checkbox"
                      class="checkbox checkbox-xs mt-0.5"
                  />
                  <span class="leading-relaxed text-base-content/70">
                    ุชุฃุฏ ูโฺฉูู
                    <button
                        type="button"
                        class="link link-primary link-hover text-[11px]"
                    >
                      ููุงูู ู ุญุฑู ุฎุตูุต ุณุงุช
                    </button>
                    ุฑุง ูุทุงูุนู ฺฉุฑุฏูโุงู ู ุจุง ุขู ููุงููู.
                  </span>
                </label>
              </div>

              <!-- ุฏฺฉูู + ูฺฉุชู -->
              <div
                  class="flex flex-col md:flex-row md:items-center gap-3 pt-2"
              >
                <button
                    class="btn btn-primary w-full md:w-auto rounded-full px-8"
                    type="submit"
                    :disabled="isSubmitting"
                >
                  <span v-if="!isSubmitting" class="flex items-center gap-2">
                    <span>ุงุฑุณุงู ูพุงู</span>
                    <span class="text-lg leading-none">โ</span>
                  </span>
                  <span v-else class="flex items-center gap-2">
                    <span
                        class="loading loading-spinner loading-sm"
                    ></span>
                    <span>ุฏุฑ ุญุงู ุงุฑุณุงู...</span>
                  </span>
                </button>

                <p
                    class="text-[11px] md:text-xs text-base-content/60 md:mr-auto"
                >
                  ุฏุฑ ุณุงุนุงุช ุดููุบุ ููฺฉู ุงุณุช ูพุงุณุฎโฺฏู ฺฉู ุจุดุชุฑ ุทูู ุจฺฉุดุฏุ ุงูุง ูฺ
                  ูพุงู ุจโุฌูุงุจ ููโูุงูุฏ โจ
                </p>
              </div>
            </form>
          </div>
        </div>

        <!-- ุณุชูู ุงุทูุงุนุงุช ุชูุงุณ / ูุงูุงุชโูุง -->
        <div class="space-y-4 lg:space-y-5">
          <!-- ฺฉุงุฑุช ุงุตู ุงุทูุงุนุงุช -->
          <div
              class="card bg-base-100/95 border border-base-200 shadow-lg shadow-base-300/30"
          >
            <div class="card-body space-y-4">
              <h3 class="card-title text-base md:text-lg justify-between">
                ุฑุงูโูุง ุงุฑุชุจุงุท ูุณุชูู
                <span
                    class="badge badge-success badge-outline text-[10px] md:text-[11px]"
                >
                  ูพุงุณุฎ ุงุฒ น ุตุจุญ ุชุง น ุดุจ
                </span>
              </h3>

              <div class="space-y-3 text-sm">
                <div class="flex items-center gap-3">
                  <div
                      class="w-9 h-9 rounded-2xl bg-primary/10 flex items-center justify-center"
                  >
                    ๐ฉ
                  </div>
                  <div class="flex flex-col gap-0.5">
                    <span class="text-[11px] text-base-content/60">
                      ุงูู ูพุดุชุจุงู
                    </span>
                    <a
                        href="mailto:support@mithrapay.ir"
                        class="link link-hover text-xs md:text-sm ltr:!text-left"
                    >
                      support@mithrapay.ir
                    </a>
                  </div>
                </div>

                <div class="flex items-center gap-3">
                  <div
                      class="w-9 h-9 rounded-2xl bg-secondary/10 flex items-center justify-center"
                  >
                    ๐
                  </div>
                  <div class="flex flex-col gap-0.5">
                    <span class="text-[11px] text-base-content/60">
                      ุชูุงุณ ุชููู
                    </span>
                    <span class="text-xs md:text-sm ltr:!text-left">
                      021-xxxxxxx
                    </span>
                  </div>
                </div>

                <div class="flex items-center gap-3">
                  <div
                      class="w-9 h-9 rounded-2xl bg-accent/10 flex items-center justify-center"
                  >
                    ๐ฌ
                  </div>
                  <div class="flex flex-col gap-0.5">
                    <span class="text-[11px] text-base-content/60">
                      ูพุดุชุจุงู ูุงุชุณุงูพ
                    </span>
                    <span class="text-xs md:text-sm ltr:!text-left">
                      09xx xxx xxxx
                    </span>
                  </div>
                </div>
              </div>

              <div class="divider my-3"></div>

              <div
                  class="grid grid-cols-2 gap-3 text-[11px] md:text-xs text-base-content/70"
              >
                <div class="space-y-1">
                  <p class="font-semibold text-sm">ุณุงุนุงุช ูพุงุณุฎโฺฏู</p>
                  <p>ูุฑ ุฑูุฒ น ุตุจุญ ุชุง น ุดุจ</p>
                </div>
                <div class="space-y-1">
                  <p class="font-semibold text-sm">ูุถุนุช ูุนู ูพุดุชุจุงู</p>
                  <p class="flex items-center gap-1">
                    <span
                        class="w-2 h-2 rounded-full bg-success animate-pulse"
                    ></span>
                    ุขููุงู
                  </p>
                </div>
              </div>

              <div class="alert alert-info mt-2 text-[11px] md:text-xs">
                <span>
                  ุจุฑุง ูพฺฏุฑ ุณูุงุฑุดุ ูุทูุงู ยซุดูุงุฑู ุณูุงุฑุดยป ุฑุง ุญุชูุงู ุฏุฑ ูุชู ูพุงู
                  ุจููุณุฏ ุชุง ุณุฑุนโุชุฑ ูพุฏุง ู ุจุฑุฑุณ ุดูุฏ.
                </span>
              </div>
            </div>
          </div>

          <!-- ฺฉุงุฑุช ูฺฉุชู / FAQ ฺฉูฺฺฉ -->
          <div
              class="card bg-gradient-to-l from-primary/10 via-base-100 to-base-100 border border-primary/20"
          >
            <div class="card-body py-3.5 px-4 space-y-1.5">
              <p class="text-xs md:text-sm font-semibold">
                ููโุฏุงูุฏ ุฏููุงู ฺู ุจููุณุฏุ
              </p>
              <p class="text-[11px] md:text-xs text-base-content/70 leading-relaxed">
                ููุท ุจุฑุง ูุง ุจููุณุฏ ฺู ฺุฒ ูโุฎูุงูุฏ ุงูุฌุงู ุฏูุฏ
                (ูุซูุงู ยซุชูุฏุฏ ุงูพู ููุฒฺฉยปุ ยซุงูุชูุงู ุงุดุชุฑุงฺฉยปุ ยซุฑูุน ุงุฑูุฑ ุขฺฉูุงุฏยป)ุ
                ุชู ูพุดุชุจุงู ุฎูุฏุดุงู ูุฑุญููโุจูโูุฑุญูู ุฑุงูููุงุชุงู ูโฺฉููุฏ ฺู
                ุงุทูุงุนุงุช ุฏฺฏุฑ ูุงุฒู ุงุณุช.
              </p>
            </div>
          </div>

          <!-- ุขูุงุฑ ุงุนุชูุงุฏ (ุงุฎุชุงุฑุ ุฏฺฉูุฑู ุฎูุจ) -->
          <div class="grid grid-cols-3 gap-3 text-center text-[11px] md:text-xs">
            <div
                class="rounded-2xl bg-base-100/90 border border-base-200 px-2.5 py-3 flex flex-col gap-1"
            >
              <span class="text-sm md:text-base font-bold text-primary">
                +ฒตฐฐ
              </span>
              <span class="text-base-content/60">
                ุณูุงุฑุด ูููู
              </span>
            </div>
            <div
                class="rounded-2xl bg-base-100/90 border border-base-200 px-2.5 py-3 flex flex-col gap-1"
            >
              <span class="text-sm md:text-base font-bold text-primary">
                ท ุฑูุฒ
              </span>
              <span class="text-base-content/60">
                ูพุดุชุจุงู ุฏุฑ ููุชู
              </span>
            </div>
            <div
                class="rounded-2xl bg-base-100/90 border border-base-200 px-2.5 py-3 flex flex-col gap-1"
            >
              <span class="text-sm md:text-base font-bold text-primary">
                โญ ด.น
              </span>
              <span class="text-base-content/60">
                ุฑุถุงุช ูุดุชุฑุงู
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</template>

<script setup lang="ts">
import { reactive, ref } from "vue";

type SubjectType =
    | "order"
    | "activation"
    | "billing"
    | "partnership"
    | "other"
    | "";

interface ContactForm {
  name: string;
  email: string;
  subject: SubjectType;
  message: string;
  phone: string;
  preferredChannel: "email" | "phone" | "whatsapp";
  acceptPolicy: boolean;
}

interface ContactErrors {
  name?: string;
  email?: string;
  subject?: string;
  message?: string;
}

const form = reactive<ContactForm>({
  name: "",
  email: "",
  subject: "",
  message: "",
  phone: "",
  preferredChannel: "email",
  acceptPolicy: false,
});

const errors = reactive<ContactErrors>({});
const isSubmitting = ref(false);

const validate = () => {
  errors.name = !form.name.trim() ? "ูุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ" : undefined;
  errors.email = !form.email.trim()
      ? "ุงูู ุฑุง ูุงุฑุฏ ฺฉูุฏ"
      : !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(form.email)
          ? "ุงูู ูุนุชุจุฑ ูุณุช"
          : undefined;
  errors.subject = !form.subject ? "ููุถูุน ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ" : undefined;
  errors.message =
      form.message.trim().length < 10
          ? "ูุทูุงู ุญุฏุงูู ฑฐ ฺฉุงุฑุงฺฉุชุฑ ุจููุณุฏ"
          : undefined;

  return !errors.name && !errors.email && !errors.subject && !errors.message;
};

const resetForm = () => {
  form.name = "";
  form.email = "";
  form.subject = "";
  form.message = "";
  form.phone = "";
  form.preferredChannel = "email";
  form.acceptPolicy = false;
};

const handleSubmit = async () => {
  if (!validate()) return;

  if (!form.acceptPolicy) {
    alert("ูุทูุงู ุงุจุชุฏุง ุจุง ููุงูู ู ุญุฑู ุฎุตูุต ููุงููุช ฺฉูุฏ.");
    return;
  }

  try {
    isSubmitting.value = true;

    // ุงูุฌุง ุจุนุฏุงู API ุงุตูโุงุช ุฑุง ุตุฏุง ุจุฒู (axios / fetch)
    // await api.contact.send(form)

    // ุฏูู: ุดุจูโุณุงุฒ ุฏุฑุฎูุงุณุช
    await new Promise((resolve) => setTimeout(resolve, 900));

    alert("ูพุงู ุดูุง ุจุง ููููุช ุงุฑุณุงู ุดุฏุ ููููู ุงุฒ ุงุนุชูุงุฏุชูู ุจู ูุชุฑุงูพ ๐ฑ");
    resetForm();
  } catch (error) {
    alert("ุฏุฑ ุงุฑุณุงู ูพุงู ุฎุทุง ุฑุฎ ุฏุงุฏุ ูุทูุงู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.");
  } finally {
    isSubmitting.value = false;
  }
};
</script>
